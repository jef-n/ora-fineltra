CREATE TABLE CHENYX06(
	OBJECTID NUMBER(*,0),
	NUM VARCHAR2(2047),
	NOM VARCHAR2(2047),
	JAHR_DEF NUMBER(*,0),
	JAHR_ELIM NUMBER(*,0),
	X1_03 FLOAT(126), Y1_03 FLOAT(126),
	X2_03 FLOAT(126), Y2_03 FLOAT(126),
	X3_03 FLOAT(126), Y3_03 FLOAT(126),
	X1_95 FLOAT(126), Y1_95 FLOAT(126),
	X2_95 FLOAT(126), Y2_95 FLOAT(126),
	X3_95 FLOAT(126), Y3_95 FLOAT(126),
	THE_GEOM_LV03 MDSYS.SDO_GEOMETRY,
	THE_GEOM_LV95 MDSYS.SDO_GEOMETRY,
	PRIMARY KEY (OBJECTID)
);

INSERT INTO CHENYX06(OBJECTID,NUM,NOM,JAHR_DEF,JAHR_ELIM,X1_03,Y1_03,X2_03,Y2_03,X3_03,Y3_03,X1_95,Y1_95,X2_95,Y2_95,x3_95,Y3_95,THE_GEOM_LV03,THE_GEOM_LV95)
	SELECT
		a."objectid",
		a."num",
		a."nom",
		a."jahr_def",
		a."jahr_elim",
		a."x1_03", a."y1_03", a."x2_03", a."y2_03", a."x3_03", a."y3_03",
		a."x1_95", a."y1_95", a."x2_95", a."y2_95", a."x3_95", a."y3_95",
		a.ORA_GEOMETRY,
		b.ORA_GEOMETRY
	FROM CHENYX06_LV03 a, CHENYX06_LV95 b WHERE a."objectid"=b."objectid";

DROP TABLE CHENYX06_LV03;
DROP TABLE CHENYX06_LV95;
DELETE FROM USER_SDO_GEOM_METADATA WHERE table_name='CHENYX06_LV03';
DELETE FROM USER_SDO_GEOM_METADATA WHERE table_name='CHENYX06_LV95';

UPDATE CHENYX06 T SET T.THE_GEOM_LV03.SDO_SRID=21781,T.THE_GEOM_LV95.SDO_SRID=2056;

DELETE FROM USER_SDO_GEOM_METADATA WHERE table_name='CHENYX06';

INSERT INTO USER_SDO_GEOM_METADATA(table_name, column_name, diminfo, srid) VALUES (
	'CHENYX06',
	'THE_GEOM_LV03',
	MDSYS.SDO_DIM_ARRAY(MDSYS.SDO_DIM_ELEMENT('X',459999.997,868000.003,0.001),MDSYS.SDO_DIM_ELEMENT('Y',41999.997,322000.003,0.001)),
	21781);

INSERT INTO USER_SDO_GEOM_METADATA(table_name, column_name, diminfo, srid) VALUES (
	'CHENYX06',
	'THE_GEOM_LV95',
	MDSYS.SDO_DIM_ARRAY(MDSYS.SDO_DIM_ELEMENT('X',2459999.997,2868000.003,0.001),MDSYS.SDO_DIM_ELEMENT('Y',1041999.997,1322000.003,0.001)),
	2056
);

CREATE INDEX CHENYX06_03_IDX ON CHENYX06(THE_GEOM_LV03) INDEXTYPE IS MDSYS.SPATIAL_INDEX PARAMETERS('LAYER_GTYPE=POLYGON');
CREATE INDEX CHENYX06_95_IDX ON CHENYX06(THE_GEOM_LV95) INDEXTYPE IS MDSYS.SPATIAL_INDEX PARAMETERS('LAYER_GTYPE=POLYGON');

@st_fineltra

show errors;

commit;

quit;
